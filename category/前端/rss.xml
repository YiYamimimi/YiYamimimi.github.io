<?xml version="1.0"?>
<rss version="2.0">
    <channel>
        <title>每一个字节都藏着无尽的智慧与灵感，欢迎来到这场知识与思想的奇妙之旅！ • Posts by &#34;前端&#34; category</title>
        <link>http://example.com</link>
        <description></description>
        <language>zh-CN</language>
        <pubDate>Tue, 12 Mar 2024 09:46:25 +0800</pubDate>
        <lastBuildDate>Tue, 12 Mar 2024 09:46:25 +0800</lastBuildDate>
        <category>部署上线</category>
        <category>Hexo</category>
        <category>教程</category>
        <category>Foo</category>
        <category>Bar</category>
        <item>
            <guid isPermalink="true">http://example.com/2024/03/12/front-end/deployment-cloudserver/</guid>
            <title>如何将前后分离的项目部署到云服务器</title>
            <link>http://example.com/2024/03/12/front-end/deployment-cloudserver/</link>
            <category>部署上线</category>
            <pubDate>Tue, 12 Mar 2024 09:46:25 +0800</pubDate>
            <description><![CDATA[ &lt;h1 id=&#34;一-购买服务器腾讯云-阿里云&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#一-购买服务器腾讯云-阿里云&#34;&gt;#&lt;/a&gt; 一、购买服务器（腾讯云、阿里云……）&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;云服务器操作系统分为 Windows 和 Linux 类，Linux 系统相对于 win 占用更少系统资源，一般选用 Linux&lt;/p&gt;
&lt;p&gt;阿里云 Linux 镜像可选 Aliyun Linux、CentOS、Ubuntu、Debian、SUSE Linux、OpenSUSE、CoreOS 和 FreeBSD。&lt;/p&gt;
&lt;p&gt;Aliyun Linux 是阿里云原生 Linux 操作系统，针对 ECS 做了大量深度优化，完全兼容 CentOS 生态和操作方式；&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;如果是 Web 网站应用，免费好用首选 CentOS；&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Ubuntu 基于 Debian，新手更容易上手，时长占有率也高。&lt;br /&gt;
综上，阿里云 ECS 云服务器 Linux 镜像&lt;strong&gt;推荐选择 Aliyun Linux、CenOS 或 Ubuntu&lt;/strong&gt; 都可以，根据用户实际熟悉程度及应用选择&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;这里选用：CentOS 7.2 的 Linux 系统&lt;/p&gt;
&lt;p&gt;前端开发工具：WebStorm vue+element&lt;br /&gt;
 后端开发工具：IDEA spring boot&lt;br /&gt;
 部署环境：阿里云 Linux &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/cT1DZW50T1M3JmFtcDtzcG09MTAwMS4yMTAxLjMwMDEuNzAyMA==&#34;&gt;CentOS7&lt;/span&gt;&lt;br /&gt;
&lt;img data-src=&#34;https://s2.loli.net/2024/03/12/b4X3vszyhOUMKpd.png&#34; alt=&#34;输入图片说明&#34; /&gt;&lt;img data-src=&#34;https://img-blog.csdnimg.cn/direct/7c0248fb88ab4ba4840447dd1f3536d2.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;二-下载-x-shell和xftp&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#二-下载-x-shell和xftp&#34;&gt;#&lt;/a&gt; 二、下载 X-shell 和 Xftp&lt;/h1&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly93d3cueHNoZWxsLmNvbS96aC9mcmVlLWZvci1ob21lLXNjaG9vbC8=&#34;&gt;家庭 / 学校免费 - NetSarang Website&lt;/span&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;每次连接服务器都要一步步连挺麻烦的 ∴借助一个第三方的工具进行远程与服务器连接&lt;/p&gt;
&lt;p&gt;管理云服务器的软件：XShell，Putty，SecureCRT 等&lt;/p&gt;
&lt;p&gt;使用的是 Xshell 和 Xftp。&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly93d3cubmV0c2FyYW5nLmNvbS9lbi9mcmVlLWZvci1ob21lLXNjaG9vbC8=&#34;&gt;Xshell&lt;/span&gt; 提供了一个终端界面用于 Shell 操作，使用 SSH 协议连接到远程服务器&lt;/p&gt;
&lt;p&gt;Xftp 支持 SSH 和 SFTP 协议，主要用于文件传输和管理&lt;br /&gt;
&lt;img data-src=&#34;https://s2.loli.net/2024/03/12/GlhV3Jaxqt8ycHz.png&#34; alt=&#34;输入图片说明&#34; /&gt;&lt;img data-src=&#34;https://img-blog.csdnimg.cn/direct/e821af5770264b91af40b11dc13a6000.png&#34; alt=&#34;&#34; /&gt;&lt;br /&gt;
&lt;img data-src=&#34;https://s2.loli.net/2024/03/12/Sfm5Pr2OIpYyUqX.png&#34; alt=&#34;输入图片说明&#34; /&gt;​&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&#34;三-部署前准备&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#三-部署前准备&#34;&gt;#&lt;/a&gt; 三、部署前准备&lt;/h1&gt;
&lt;h3 id=&#34;1-打包前端文件dis&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#1-打包前端文件dis&#34;&gt;#&lt;/a&gt; 1、打包前端文件 dis&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;修改 baseUrl：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;新建文件.env.development（本地配置）&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;VUE_APP_BASEURL=&#39;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL2xvY2FsaG9zdDo5MDkw&#34;&gt;http://localhost:9090&lt;/span&gt;&#39;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;新建文件..env.production（开发配置）&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;VUE_APP_BASEURL=&#39;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL3huLS16ZnJ1MWdmcjZiejYzaTo5MDkw&#34;&gt;http:// 服务器地址：9090&lt;/span&gt;&#39;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;main.js 设置全局变量 $baseUrl&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Vue.prototype.$baseUrl=process.env.VUE_APP_BASEURL&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h6 id=&#34;打包npm-run-build&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#打包npm-run-build&#34;&gt;#&lt;/a&gt; 打包：npm run build&lt;/h6&gt;
&lt;p&gt;&lt;strong&gt;vue-cli-service 默认会读取 env.development 文件&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://s2.loli.net/2024/03/12/hKqx1lCOISiRuUp.png&#34; alt=&#34;输入图片说明&#34; /&gt;&lt;img data-src=&#34;https://img-blog.csdnimg.cn/direct/5673f9c795864f8e9fc104f2b842d0b8.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;2-打包后端文件jar&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#2-打包后端文件jar&#34;&gt;#&lt;/a&gt; &lt;strong&gt;2、打包后端文件 jar&lt;/strong&gt;&lt;/h3&gt;
&lt;h6 id=&#34;打包-mvn-clean-package-执行打包后的jar&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#打包-mvn-clean-package-执行打包后的jar&#34;&gt;#&lt;/a&gt; 打包 ：mvn clean package &lt;strong&gt;执行打包后的 jar&lt;/strong&gt;&lt;/h6&gt;
&lt;p&gt;&lt;img data-src=&#34;https://s2.loli.net/2024/03/12/SlLI9BWxyMza6nh.png&#34; alt=&#34;输入图片说明&#34; /&gt;&lt;img data-src=&#34;https://img-blog.csdnimg.cn/direct/b05750815cbe42889cfef887fc6321e6.png&#34; alt=&#34;&#34; /&gt;&lt;img data-src=&#34;https://s2.loli.net/2024/03/12/8kPJF9cO3r12QHy.png&#34; alt=&#34;输入图片说明&#34; /&gt;&lt;img data-src=&#34;https://img-blog.csdnimg.cn/direct/eaf87cd4a440487295aba5f15b858c2c.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;3-打包后可以先尝试一下运行打包的文件&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#3-打包后可以先尝试一下运行打包的文件&#34;&gt;#&lt;/a&gt; 3、打包后可以先尝试一下运行打包的文件&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;用 serve 执行前端打包的 dis&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://s2.loli.net/2024/03/12/6wNPn5IxCcOLrjV.png&#34; alt=&#34;输入图片说明&#34; /&gt;&lt;img data-src=&#34;https://img-blog.csdnimg.cn/direct/2283f68ab5254ebab6839338117ec459.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;用 java -jar 执行后端打包的 jar&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://s2.loli.net/2024/03/12/o4HRTYMKUBquyPt.png&#34; alt=&#34;输入图片说明&#34; /&gt;&lt;img data-src=&#34;https://img-blog.csdnimg.cn/direct/bd0e1e2340c745b4a5e211f20b13e2d4.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;四-部署云服务器的环境并将打包的前后端文件上传上去&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#四-部署云服务器的环境并将打包的前后端文件上传上去&#34;&gt;#&lt;/a&gt; 四、 部署云服务器的环境并将打包的前后端文件上传上去&lt;/h1&gt;
&lt;h3 id=&#34;1-使用上面下载的x-shell和xftp安装软件nginx-jdk-mysql&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#1-使用上面下载的x-shell和xftp安装软件nginx-jdk-mysql&#34;&gt;#&lt;/a&gt; 1、使用上面下载的 X-shell 和 Xftp 安装软件：&lt;strong&gt;nginx、jdk、mysql&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;&lt;img data-src=&#34;https://s2.loli.net/2024/03/12/hOYrmWekdV1L5Q6.png&#34; alt=&#34;输入图片说明&#34; /&gt;&lt;img data-src=&#34;https://img-blog.csdnimg.cn/direct/9516a25e3deb4da9bd8b0620639e1ca3.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;h4 id=&#34;安装jdk18&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#安装jdk18&#34;&gt;#&lt;/a&gt; 安装 jdk1.8&lt;/h4&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;# 要解压的目录			&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;tar -zxvf /tmp/jdk-8u371-linux-x64.tar.gz -C /usr/local/&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mv /usr/local/jdk1.8.0_371 /usr/local/java&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;vi /etc/profile&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;# 进到profile文件里进行编辑，再最后一行追加内容&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;export JAVA_HOME=/usr/local/java&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;export PATH=$JAVA_HOME/bin:$PATH&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;#执行&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;source /etc/profile&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;# 验证&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;java -version&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;br /&gt;
&lt;img data-src=&#34;https://s2.loli.net/2024/03/12/MZFnhrScHQpY6ue.png&#34; alt=&#34;输入图片说明&#34; /&gt;&lt;img data-src=&#34;https://img-blog.csdnimg.cn/direct/87952263eef249dda2a602ea313ef8c6.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;h4 id=&#34;安装nginx&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#安装nginx&#34;&gt;#&lt;/a&gt; 安装 nginx&lt;/h4&gt;
&lt;p&gt;a. 安装库文件&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;#安装 gcc&lt;br /&gt;
yum install gcc-c++&lt;/p&gt;
&lt;p&gt;#安装 PCRE pcre-devel&lt;br /&gt;
yum install -y pcre pcre-devel&lt;/p&gt;
&lt;p&gt;#安装 zlib&lt;br /&gt;
yum install -y zlib zlib-devel&lt;/p&gt;
&lt;p&gt;#安装 Open SSL&lt;br /&gt;
yum install -y openssl openssl-devel&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;b. 解压、编译 nginx 并安装&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;mkdir /usr/local/nginx&lt;br /&gt;
tar -zxvf /tmp/nginx-1.24.0.tar.gz -C /usr/local/nginx&lt;/p&gt;
&lt;p&gt;cd /usr/local/nginx/nginx-1.24.0&lt;br /&gt;
# 编译安装&lt;br /&gt;
./configure --with-http_stub_status_module --with-http_ssl_module&lt;br /&gt;
make &amp;amp;&amp;amp; make install&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;c.nginx 命令&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;cd /usr/local/nginx/sbin&lt;br /&gt;
./nginx # 启动&lt;/p&gt;
&lt;p&gt;ps -ef | grep nginx # 查看&lt;br /&gt;
./nginx -s stop # 停止&lt;br /&gt;
./nginx -s reload # 重启&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;ps -ef | grep nginx&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img data-src=&#34;https://s2.loli.net/2024/03/12/sfkmwhqGUFjQYbL.png&#34; alt=&#34;输入图片说明&#34; /&gt;&lt;img data-src=&#34;https://img-blog.csdnimg.cn/direct/ecb7a50970c3425087df3fd9b4692157.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;d.nginx 配置&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://s2.loli.net/2024/03/12/1S4VmBLPkclzpYA.png&#34; alt=&#34;输入图片说明&#34; /&gt;&lt;img data-src=&#34;https://img-blog.csdnimg.cn/direct/432e6bb1b60444e5b12382fbc7c1bd98.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;server &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    listen       80;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    server_name  localhost;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    #charset koi8-r;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    #access_log  logs/host.access.log  main;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    location / &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        root   /home/server/honey2024/vue/dist;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        index  index.html index.htm;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        try_files $uri $uri/ /index.html;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==&#34; alt=&#34;&#34; title=&#34;点击并拖拽以移动&#34; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;root 填写前端打包的文件 dist 位置；&lt;/p&gt;
&lt;p&gt;root /home/server/honey2024/vue/dist; // 访问你打包的 vue 文件 dis&lt;/p&gt;
&lt;p&gt;try_files $uri $uri//index.html; // 因为用了 vue-router&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;e. 执行命令重启：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;d /usr/local/nginx/sbin&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;./nginx -s reload&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;安装mysql&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#安装mysql&#34;&gt;#&lt;/a&gt; 安装 mysql&lt;/h4&gt;
&lt;p&gt;linux 系统会自动携带一个数据库，我们需要把它给卸载掉&lt;/p&gt;
&lt;p&gt;通过以下代码可以查看 mariadb 并卸载&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;rpm -qa | grep mariadb&lt;br /&gt;
yum remove -y mariadb-connector-c-3.1.11-2.oc8.1.x86_64&lt;br /&gt;
yum remove -y mariadb-connector-c-config-3.1.11-2.oc8.1.noarch&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;下载 mysql 并 上传到 /tmp 目录&lt;/p&gt;
&lt;p&gt;安装 mysql 命令：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;mkdir /data/mysql&lt;br /&gt;
tar -zxvf /tmp/mysql-5.7.42-el7-x86_64.tar.gz -C /usr/local&lt;br /&gt;
mv /usr/local/mysql-5.7.42-el7-x86_64 /usr/local/mysql&lt;/p&gt;
&lt;p&gt;#添加用户组&lt;br /&gt;
 groupadd mysql&lt;br /&gt;
useradd -r -g mysql mysql&lt;br /&gt;
chown -R mysql.mysql /usr/local/mysql&lt;br /&gt;
chown -R mysql.mysql /data/mysql&lt;/p&gt;
&lt;p&gt;cd /usr/local/mysql&lt;br /&gt;
/usr/local/mysql/bin/mysqld --user=mysql --basedir=/usr/local/mysql/ --datadir=/data/mysql --initialize&lt;/p&gt;
&lt;p&gt;#将 mysql 加入到服务中&lt;br /&gt;
 cp /usr/local/mysql/support-files/mysql.server/etc/init.d/mysql&lt;/p&gt;
&lt;p&gt;#mysql 快捷方式&lt;br /&gt;
 ln -s /usr/local/mysql/bin/mysql/usr/bin&lt;br /&gt;
ln -s /usr/lib64/libtinfo.so.6.1 /usr/lib64/libtinfo.so.5&lt;br /&gt;
ln -s /usr/lib64/libncurses.so.6.1 /usr/lib64/libncurses.so.5&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img data-src=&#34;https://s2.loli.net/2024/03/12/wtORhejnGiMpbXd.png&#34; alt=&#34;输入图片说明&#34; /&gt;&lt;img data-src=&#34;https://img-blog.csdnimg.cn/direct/a07f434f64b441be994253d38721489b.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;记住上面的临时密码&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;配置 mysql 配置文件 my.cnf&lt;/p&gt;
&lt;p&gt;vi /etc/my.cnf&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;[mysqld]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;datadir=/data/mysql&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;basedir=/usr/local/mysql&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;socket=/tmp/mysql.sock&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;user=mysql&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;port=3306&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;character-set-server=utf8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;# 取消密码验证&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;# skip-grant-tables&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;# # Disabling symbolic-links is recommended to prevent assorted security risks&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;symbolic-links=0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;[mysqld_safe]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;log-error=/var/log/mysqld.log&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;pid-file=/var/run/mysqld/mysqld.pid&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==&#34; alt=&#34;&#34; title=&#34;点击并拖拽以移动&#34; /&gt;&lt;/p&gt;
&lt;p&gt;启动 mysql： &lt;strong&gt;service mysql start&lt;/strong&gt;&lt;br /&gt;
&lt;img data-src=&#34;https://s2.loli.net/2024/03/12/GbtDk2QeIML9Pp4.png&#34; alt=&#34;输入图片说明&#34; /&gt;&lt;img data-src=&#34;https://img-blog.csdnimg.cn/direct/6f2eb3caa5ce4b84ac946983fff4557a.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;开机启动: &lt;strong&gt;chkconfig mysql on&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;登录 mysql： &lt;strong&gt;mysql -uroot -p&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;输入临时密码进入 mysql 修改密码并设置权限：&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;修改密码并设置权限：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;SET PASSWORD = PASSWORD(&#39;1234&#39;);&lt;/p&gt;
&lt;p&gt;use mysql;&lt;br /&gt;
update user set host =&#39;%&#39;where user =&#39;root&#39; and host =&#39;localhost&#39;;&lt;br /&gt;
flush privileges;&lt;br /&gt;
exit;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;使用 SQLyogt 连接 mysql&lt;br /&gt;
&lt;img data-src=&#34;https://s2.loli.net/2024/03/12/5p8IozrvsNikdVg.png&#34; alt=&#34;输入图片说明&#34; /&gt;&lt;img data-src=&#34;https://img-blog.csdnimg.cn/direct/2ab6a2c5a1454a8e9139d0be93d397c4.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;设置服务器防火墙：&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://s2.loli.net/2024/03/12/Aytrz74mKqWZjli.png&#34; alt=&#34;输入图片说明&#34; /&gt;&lt;img data-src=&#34;https://img-blog.csdnimg.cn/img_convert/a3aba07361c9736e21cc4bbc1d5c304a.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;新建数据库并将本地数据库导入远程的&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://s2.loli.net/2024/03/12/8hnF9ESTYcmKHwO.png&#34; alt=&#34;输入图片说明&#34; /&gt;&lt;img data-src=&#34;https://img-blog.csdnimg.cn/direct/a668d0217a7e44a3b0690c51698afacc.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;2-部署前端文件dist&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#2-部署前端文件dist&#34;&gt;#&lt;/a&gt; 2、部署前端文件 dist&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;使用 X-shell 和 Xftp 创建文件夹：mkdir -p /home/server/honey2024&lt;/p&gt;
&lt;p&gt;上传 dist 文件夹到 /home/server/honey2024/vue&lt;br /&gt;
&lt;img data-src=&#34;https://s2.loli.net/2024/03/12/G81AVIKaUtLr2Cc.png&#34; alt=&#34;输入图片说明&#34; /&gt;&lt;img data-src=&#34;https://img-blog.csdnimg.cn/direct/22482fc05efe48ff9e4a4b2b1ea872d2.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;3-部署后端文件jar&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#3-部署后端文件jar&#34;&gt;#&lt;/a&gt; 3、部署后端文件 jar&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;上传 jar 包到服务器 /home/server/honey2024/java 目录&lt;/p&gt;
&lt;p&gt;设置 application.yml 覆盖&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://s2.loli.net/2024/03/12/Qo85wHYhsd4GfOT.png&#34; alt=&#34;输入图片说明&#34; /&gt;&lt;img data-src=&#34;https://img-blog.csdnimg.cn/direct/158e7bc99ce44623950bfbe4d7ef7506.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;添加 启动和停止脚本&lt;/p&gt;
&lt;p&gt;cd /home/server/honey2024/java&lt;/p&gt;
&lt;p&gt;vi &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL3N0YXJ0LnNo&#34;&gt;start.sh&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;NAME=springboot-0.0.1-SNAPSHOT.jar&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;nohup java -jar $NAME &amp;gt; server.log 2&amp;gt;&amp;amp;1 &amp;amp;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;echo &amp;#x27;start success&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==&#34; alt=&#34;&#34; title=&#34;点击并拖拽以移动&#34; /&gt;&lt;/p&gt;
&lt;p&gt;vi &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL3N0b3Auc2g=&#34;&gt;stop.sh&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;PORT=8082&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;pid=`netstat -tnlp | grep $PORT | grep -v grep | awk &amp;#x27;&amp;#123;print $7&amp;#125;&amp;#x27; | awk -F/ &amp;#x27;&amp;#123;print $1&amp;#125;&amp;#x27;`&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;if [ $&amp;#123;pid&amp;#125; ]; then&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    kill -9 $pid&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    echo &amp;quot;kill $PORT&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;else&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    echo &amp;#x27;stop sucess!&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;fi&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==&#34; alt=&#34;&#34; title=&#34;点击并拖拽以移动&#34; /&gt;&lt;/p&gt;
&lt;p&gt;赋权 chmod +x *&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://s2.loli.net/2024/03/12/eyC8A4cjFItzrqM.png&#34; alt=&#34;输入图片说明&#34; /&gt;&lt;img data-src=&#34;https://img-blog.csdnimg.cn/img_convert/af71c27e94d0b3ed81d4ade71b0a0963.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;去除脚本文件里的特殊符号（可选）&lt;/p&gt;
&lt;p&gt;sed -i &#39;s/\r//&#39; &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL3N0YXJ0LnNo&#34;&gt;start.sh&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;sed -i &#39;s/\r//&#39; &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL3N0b3Auc2g=&#34;&gt;stop.sh&lt;/span&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;完成后的目录文件：&lt;br /&gt;
&lt;img data-src=&#34;https://s2.loli.net/2024/03/12/Jxbpt64o5NDvzS7.png&#34; alt=&#34;输入图片说明&#34; /&gt;&lt;img data-src=&#34;https://img-blog.csdnimg.cn/img_convert/82a26e54d3f33639b707cf8b01b26837.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;4-启动程序&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#4-启动程序&#34;&gt;#&lt;/a&gt; 4、启动程序：&lt;/h3&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;cd /home/server/honey2024/java&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;./start.sh&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==&#34; alt=&#34;&#34; title=&#34;点击并拖拽以移动&#34; /&gt;&lt;/p&gt;
&lt;p&gt;实时查看日志：&lt;strong&gt;tail -100f server.log&lt;/strong&gt;&lt;br /&gt;
&lt;img data-src=&#34;https://s2.loli.net/2024/03/12/GQfnkVmty4PNUc3.png&#34; alt=&#34;输入图片说明&#34; /&gt;&lt;img data-src=&#34;https://img-blog.csdnimg.cn/direct/ee52847a4f204a8b98b5daab7e48318d.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;设置防火墙端口 9090&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://s2.loli.net/2024/03/12/PiQwpEYj7R4ODVA.png&#34; alt=&#34;输入图片说明&#34; /&gt;&lt;img data-src=&#34;https://img-blog.csdnimg.cn/img_convert/d8247649bb27d50bb809b9f9e0173f16.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;之后，访问公网 ip 可以预览上线项目了&lt;/p&gt;
&lt;p&gt;题外话：可以&lt;strong&gt;在云服务器上安装宝塔面板来管理项目&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;​&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://example.com/2023/01/02/front-end/no-title/</guid>
            <title>Excel 导入导出（前端处理：xslx）（后端处理：hutool+poi || Easy Excel ）</title>
            <link>http://example.com/2023/01/02/front-end/no-title/</link>
            <pubDate>Mon, 02 Jan 2023 20:46:25 +0800</pubDate>
            <description><![CDATA[ &lt;h1 id=&#34;excel-导入导出前端处理xslx&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#excel-导入导出前端处理xslx&#34;&gt;#&lt;/a&gt; Excel 导入导出（前端处理：xslx）&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;调用文件对象的&lt;/strong&gt; &lt;strong&gt;arrayBuffer&lt;/strong&gt; 方法读取文件，然后使用 **xslx.**&lt;strong&gt;read&lt;/strong&gt; 方法解析数为 &lt;strong&gt;Excel 工作簿对象&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;readAsBinaryString&lt;/strong&gt; 和 &lt;strong&gt;readAsArrayBuffer&lt;/strong&gt; 是 &lt;strong&gt;FileReader&lt;/strong&gt; 对象的两种不同读取文件的方式：&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;创建 &lt;strong&gt;FileReader&lt;/strong&gt; 对象。使用&lt;strong&gt; FileReader&lt;/strong&gt; &lt;strong&gt;对象的读取文件方法&lt;/strong&gt;： &lt;strong&gt;readAsBinaryString&lt;/strong&gt; ，将文件读取为二进制字符串；或使用 &lt;strong&gt;readAsArrayBuffer&lt;/strong&gt; 方法会将文件读取为二进制数据缓冲区，即&lt;strong&gt; ArrayBuffer 对象。&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;再使用 **xslx.**&lt;strong&gt;read&lt;/strong&gt; 方法解析数据为 Excel 工作簿对象&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;3. 下图为&lt;strong&gt; Excel 工作簿对象&lt;/strong&gt;实例：&lt;br /&gt;
&lt;img data-src=&#34;https://s2.loli.net/2024/01/16/Bnj6OHGy1V8TeIq.png&#34; alt=&#34;输入图片说明&#34; /&gt;&lt;img data-src=&#34;https://cdn.nlark.com/yuque/0/2023/webp/32496480/1703057873177-0ebecc5d-f693-47af-9191-4f6e983747fa.webp?x-oss-process=image%2Fresize%2Cw_588%2Climit_0&#34; alt=&#34;&#34; /&gt;&lt;br /&gt;
&lt;img data-src=&#34;https://s2.loli.net/2024/01/16/8OATF9epYVawxur.png&#34; alt=&#34;输入图片说明&#34; /&gt;&lt;img data-src=&#34;https://cdn.nlark.com/yuque/0/2024/webp/32496480/1705325153314-84eec0f5-a70b-4f40-ba5a-3b6c51fcf013.webp?x-oss-process=image%2Fresize%2Cw_720%2Climit_0&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;代码示例&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#代码示例&#34;&gt;#&lt;/a&gt; 代码示例&lt;/h2&gt;
&lt;h3 id=&#34;导入excel数据&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#导入excel数据&#34;&gt;#&lt;/a&gt; 导入 Excel 数据&lt;/h3&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;const reader = new FileReader()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;reader.readAsBinaryString(file)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;reader.onload = function (e) &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    const data = e.target.result&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    let wb = XLSX.read(data, &amp;#123;//Excel 工作簿对象，打印如上&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        type: &amp;#x27;binary&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;const reader = new FileReader()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;reader.readAsArrayBuffer(file)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;reader.onload = function (e) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    const data = e.target.result&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    let wb = XLSX.read(data, &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        type: &amp;#x27;array&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;details&gt;&lt;summary&gt;解析&lt;/summary&gt;&lt;div&gt;
&lt;blockquote&gt;
&lt;ol&gt;
&lt;li&gt;创建 &lt;strong&gt;FileReader&lt;/strong&gt; 对象。&lt;/li&gt;
&lt;li&gt;使用&lt;strong&gt; FileReader&lt;/strong&gt; &lt;strong&gt;对象的读取文件方法&lt;/strong&gt;： &lt;strong&gt;readAsBinaryString&lt;/strong&gt; ，将文件读取为二进制字符串。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;（使用 &lt;strong&gt;readAsArrayBuffer&lt;/strong&gt; 方法会将文件读取为二进制数据缓冲区，即&lt;strong&gt; ArrayBuffer 对象&lt;/strong&gt;）&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;设置 &lt;strong&gt;onload&lt;/strong&gt; 回调函数，该函数在文件读取成功后触发。&lt;/li&gt;
&lt;li&gt;在回调函数中，通过 &lt;strong&gt;e.target.result&lt;/strong&gt; 获取读取文件成功的结果值，即文件的二进制数据。&lt;/li&gt;
&lt;li&gt;使用 &lt;strong&gt;XLSX.read&lt;/strong&gt; 方法解析&lt;strong&gt;二进制字符串&lt;/strong&gt;或&lt;strong&gt; ArrayBuffer 对象&lt;/strong&gt;为 Excel 工作簿对象&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;（&lt;strong&gt;type: &#39;binary&#39;&lt;/strong&gt; 表示解析的数据类型是二进制字符串；&lt;strong&gt;type: &#39;array&#39;&lt;strong&gt; 表解析的数据类型是&lt;/strong&gt; ArrayBuffer 对象&lt;/strong&gt;）&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;如果提供了回调函数 &lt;strong&gt;callback&lt;/strong&gt;，则调用该函数，并将解析得到的 &lt;strong&gt;workbook&lt;/strong&gt; 对象传递给回调函数。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;这个流程适用于在前端处理 Excel 文件，你可以在回调函数中进一步处理 &lt;strong&gt;workbook&lt;/strong&gt; 对象，比如获取工作表、将工作表转换为 JSON 等。&lt;/p&gt;
&lt;p&gt;/*&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;readAsBinaryString&lt;/strong&gt; 和 &lt;strong&gt;readAsArrayBuffer&lt;/strong&gt; 是 &lt;strong&gt;FileReader&lt;/strong&gt; 对象的两种不同读取文件的方式。&lt;/p&gt;
&lt;p&gt;readAsBinaryString 方法是过时的&lt;/p&gt;
&lt;p&gt;官方推荐使用 readAsArrayBuffer 方法&lt;/p&gt;
&lt;p&gt;*/&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/div&gt;&lt;/details&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&amp;lt;input ref=&amp;quot;excel-upload-input&amp;quot; class=&amp;quot;excel-upload-input&amp;quot; type=&amp;quot;file&amp;quot; accept=&amp;quot;.xlsx, .xls&amp;quot; @change=&amp;quot;handleClick&amp;quot;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;let _file = e.target.files[0];//获取input标签里的文件&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;_file.arrayBuffer().then((res) =&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    const wb = XLSX.read(res);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;details&gt;&lt;summary&gt;解析&lt;/summary&gt;&lt;div&gt;
&lt;blockquote&gt;
&lt;p&gt;使用 arrayBuffer 方法，更符合现代 JavaScript 异步风格&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;获取 input 标签里的文件&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;调用文件对象的&lt;/strong&gt; &lt;strong&gt;arrayBuffer&lt;/strong&gt; 方法，该方法返回一个 Promise，该 Promise 在文件数据准备好时解析。&lt;/li&gt;
&lt;li&gt;在 &lt;strong&gt;then&lt;/strong&gt; 方法中，获取解析后的二进制数据 &lt;strong&gt;res&lt;/strong&gt;。&lt;/li&gt;
&lt;li&gt;使用 &lt;strong&gt;XLSX.read&lt;/strong&gt; 方法解析二进制数据，得到 &lt;strong&gt;wb&lt;/strong&gt;，这里的 &lt;strong&gt;read&lt;/strong&gt; 方法是你项目中封装的读取 Excel 数据的函数。&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;/div&gt;&lt;/details&gt;
&lt;h3 id=&#34;将数据封装好后传给后端&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#将数据封装好后传给后端&#34;&gt;#&lt;/a&gt; 将数据封装好后传给后端&lt;/h3&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;// XLSX.utils.sheet_to_json&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;const sheet1 = wb.Sheets.Sheet1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;const _data = utils.sheet_to_json(sheet1);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;const wsname = wb.SheetNames[0]; //取Excel 工作簿对象的第一张表&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;const ws = XLSX.utils.sheet_to_json(wb.Sheets[wsname]); //将那张表转成json表格内容(实际上是数组)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;//把解析出来的Excel数据，直接转成表格需要的数据&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ws.forEach((item) =&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    that.lists.push(&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        //处理后端要接收的数据格式&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        // factoryName: item[&amp;quot;工厂&amp;quot;],&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        // wokhouseName: item[&amp;quot;车间&amp;quot;],&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    console.log(that.lists);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;details&gt;&lt;summary&gt;解析&lt;/summary&gt;&lt;div&gt;
&lt;blockquote&gt;
&lt;ol&gt;
&lt;li&gt;取 Excel 工作簿对象的第一张表&lt;/li&gt;
&lt;li&gt;使用&lt;strong&gt; XLSX.utils.sheet_to_json&lt;/strong&gt; 将那张表转成 json 表格内容&lt;/li&gt;
&lt;li&gt;可处理转化的 JSON 数据为后端所需要的格式&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;/div&gt;&lt;/details&gt;
&lt;h3 id=&#34;导出数据&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#导出数据&#34;&gt;#&lt;/a&gt; 导出数据&lt;/h3&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;let book = XLSX.utils.book_new()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;let aoa = [&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  [&amp;#x27;姓名&amp;#x27;, &amp;#x27;性别&amp;#x27;, &amp;#x27;年龄&amp;#x27;, &amp;#x27;注册时间&amp;#x27;],&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  [&amp;#x27;张三&amp;#x27;, &amp;#x27;男&amp;#x27;, 18, new Date()],&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  [&amp;#x27;李四&amp;#x27;, &amp;#x27;女&amp;#x27;, 22, new Date()]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;// 将一个二维数组转成sheet&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;// aoa_to_sheet: 这个工具类最强大也最实用了，将一个二维数组转成sheet，会自动处理number、string、boolean、date等类型数据；&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;let sheet = XLSX.utils.aoa_to_sheet(aoa);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;XLSX.utils.book_append_sheet(book, sheet, &amp;quot;sheet1&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;XLSX.writeFile(book, `user$&amp;#123;new Date().getTime()&amp;#125;.xls`)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;const wb = XLSX.utils.book_new(); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;let data = [&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#123; name: &amp;quot;张三&amp;quot;, id: 100, score: 99 &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#123; name: &amp;quot;张四&amp;quot;, id: 200, score: 99 &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#123; name: &amp;quot;张五&amp;quot;, id: 300, score: 99 &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;]//转化JSON数组 &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;const ws = XLSX.utils.json_to_sheet(data); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;XLSX.utils.book_append_sheet(wb, ws, &amp;quot;people&amp;quot;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;XLSX.writeFile(wb, &amp;quot;test1.xlsx&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;details&gt;&lt;summary&gt;解析&lt;/summary&gt;&lt;div&gt;
&lt;blockquote&gt;
&lt;ol&gt;
&lt;li&gt;使用 XLSX.utils.aoa_to_sheet 方法将一个二维数组转化为一个工作表 (sheet)。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;一个包含对象的数组 &lt;strong&gt;data&lt;/strong&gt;，通过 &lt;strong&gt;XLSX.utils.json_to_sheet&lt;/strong&gt; 方法将其转换为 Excel 工作表&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;使用&lt;strong&gt; XLSX.utils.book_new&lt;/strong&gt; 方法创建一个新的工作簿 (book)。&lt;/li&gt;
&lt;li&gt;使用&lt;strong&gt; XLSX.utils.book_append_sheet&lt;/strong&gt; 方法将之前创建的工作表添加到工作簿中，并命名为 &amp;quot;sheet1&amp;quot;。&lt;/li&gt;
&lt;li&gt;使用&lt;strong&gt; XLSX.writeFile&lt;/strong&gt; 方法将工作簿保存为一个 Excel 文件。&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;/div&gt;&lt;/details&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;const reader = new FileReader()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;reader.readAsBinaryString(file)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;//onload 回调函数，该函数在文件读取成功后触发&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;reader.onload = function (e) &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    //回调函数中，通过 e.target.result 获取读取文件成功的结果值，即文件的二进制数据BinaryString&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    const data = e.target.result&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    //使用 XLSX.read 方法解析二进制数据BinaryString，type: &amp;#x27;binary为 Excel 工作簿对象&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    let wb = XLSX.read(data, &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        type: &amp;#x27;binary&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;/* &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;readAsBinaryString 和 readAsArrayBuffer 是 FileReader 对象的两种不同读取文件的方式。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;readAsBinaryString 方法是过时的&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;官方推荐使用 readAsArrayBuffer 方法&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;*/&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;const reader = new FileReader()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;reader.readAsArrayBuffer(file)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;reader.onload = function (e) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    const data = e.target.result&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    let wb = XLSX.read(data, &amp;#123;//Excel 工作簿对象&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        type: &amp;#x27;array&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;//————————————————————————————————————————————————————————&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;lt;input ref=&amp;quot;excel-upload-input&amp;quot; class=&amp;quot;excel-upload-input&amp;quot; type=&amp;quot;file&amp;quot; accept=&amp;quot;.xlsx, .xls&amp;quot; @change=&amp;quot;handleClick&amp;quot;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;//使用 arrayBuffer 方法，更符合现代 JavaScript 异步风格&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;let _file = e.target.files[0];//获取input标签里的文件&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;//调用文件对象的arrayBuffer方法，该方法返回一个 Promise，该 Promise 在文件数据准备好时解析&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;_file.arrayBuffer().then((res) =&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	//在 then 方法中，获取解析后的二进制数据 res。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    const wb = read(res);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;//————————————————————————————————————————————————————&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;// XLSX.utils.sheet_to_json&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;const sheet1 = wb.Sheets.Sheet1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;const _data = utils.sheet_to_json(sheet1);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;const wsname = wb.SheetNames[0]; //取Excel 工作簿对象的第一张表&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;const ws = XLSX.utils.sheet_to_json(wb.Sheets[wsname]); //将那张表转成json表格内容(实际上是 )&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;//把解析出来的Excel数据，直接转成表格需要的数据&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ws.forEach((item) =&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    that.lists.push(&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        //处理后端要接收的数据格式&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        // factoryName: item[&amp;quot;工厂&amp;quot;],&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        // wokhouseName: item[&amp;quot;车间&amp;quot;],&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    console.log(that.lists);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;) &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h3 id=&#34;预览vue-officeexceldocx-preview&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#预览vue-officeexceldocx-preview&#34;&gt;#&lt;/a&gt; 预览（vue-office/excel&amp;quot;……；docx-preview）&lt;/h3&gt;
&lt;p&gt;&lt;img data-src=&#34;https://s2.loli.net/2024/01/16/PAGosrNldZ5BSYE.png&#34; alt=&#34;输入图片说明&#34; /&gt;&lt;img data-src=&#34;https://cdn.nlark.com/yuque/0/2023/png/32496480/1701781354926-92e813d6-8499-4a15-8d5e-15ce458bce36.png&#34; alt=&#34;image.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;上传后预览&lt;br /&gt;
 &lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&amp;lt;vueofficeExcel v-if=&amp;quot;excelSrc&amp;quot; :src=&amp;quot;excelSrc&amp;quot; style=&amp;quot;height:500px&amp;quot;&amp;gt;&amp;lt;/vueofficeExcel&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;lt;input type=&amp;quot;file&amp;quot; @change=&amp;quot;change&amp;quot; /&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;import vueofficeExcel from &amp;quot;@vue-office/excel&amp;quot;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;import vueofficedocx from &amp;quot;@vue-office/docx&amp;quot;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;import vueofficedpdf from &amp;quot;@vue-office/pdf&amp;quot;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;change(e) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  let _file = e.target.files[0]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  const fr = new FileReader();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  fr.readAsDataURL(_file);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  fr.onload = (e) =&amp;gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    this.excelSrc = e.target.result;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;br /&gt;
 上传后预览（做图片缩略图）&lt;br /&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;let fr = new FileReader(); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;fr.readAsDataURL(file);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;let self = this;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;fr.onload = function () &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  self.imgbase64 = fr.result&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;br /&gt;
docx-preview 也可用于 docx 预览&lt;br /&gt;
 &lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&amp;lt;div ref=&amp;quot;docxPreview&amp;quot;&amp;gt;&amp;lt;/div&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;import &amp;#123; renderAsync &amp;#125; from &amp;quot;docx-preview&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;let _file = e.target.files[0];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;//blob, arrayBuffer&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;renderAsync(_file, this.$refs.docxPreview)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h1 id=&#34;二-excel-导入导出后端处理hutoolpoi-easy-excel&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#二-excel-导入导出后端处理hutoolpoi-easy-excel&#34;&gt;#&lt;/a&gt; 二、Excel 导入导出 (后端处理：hutool+poi || Easy Excel)&lt;/h1&gt;
&lt;h2 id=&#34;1-前端&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#1-前端&#34;&gt;#&lt;/a&gt; 1、前端&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;思路：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;导入：前端直接返回给后端&lt;strong&gt;文件对象&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;导出选中的或导出全部：&lt;strong&gt;将选中的 id 记录在 ids 数组里&lt;/strong&gt;；根据 ids 数组长度判断是选中导出还是导出全部；&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;调用接口：&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;导出全部的可向后端传入 ids.join (&#39;,&#39;)// 把数组转成字符串&lt;/p&gt;
&lt;p&gt;导出全部的传入用户名参数&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;代码示例&lt;br /&gt;
 &lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;handleImport(res, file, fileList) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  if (res.code === &amp;#x27;200&amp;#x27;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    this.$message.success(&amp;quot;操作成功&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    this.load(1)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125; else &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    this.$message.error(res.msg)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;exportData() &amp;#123;   // 批量导出数据&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  if (!this.ids.length) &amp;#123;   // 没有选择行的时候，全部导出  或者根据我的搜索条件导出&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    window.open(&amp;#x27;http://localhost:9090/user/export?token=&amp;#x27; + this.user.token + &amp;quot;&amp;amp;username=&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        + this.username + &amp;quot;&amp;amp;name=&amp;quot; + this.name)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125; else &amp;#123;      // [1,2,3] =&amp;gt; &amp;#x27;1,2,3&amp;#x27;//选中的导出&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    let idStr = this.ids.join(&amp;#x27;,&amp;#x27;)//把数组转成字符串&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    window.open(&amp;#x27;http://localhost:9090/user/export?token=&amp;#x27; + this.user.token + &amp;#x27;&amp;amp;ids=&amp;#x27; + idStr)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;2-后端使用hutool处理excel-文件&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#2-后端使用hutool处理excel-文件&#34;&gt;#&lt;/a&gt; 2、后端使用 Hutool 处理 Excel 文件&lt;/h2&gt;
&lt;h3 id=&#34;hutool-poi是针对apache-poi的封装因此需要用户自行引入poi库&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#hutool-poi是针对apache-poi的封装因此需要用户自行引入poi库&#34;&gt;#&lt;/a&gt; Hutool-poi 是针对 Apache POI 的封装，因此需要用户自行引入 POI 库&lt;/h3&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;lt;groupId&amp;gt;cn.hutool&amp;lt;/groupId&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;lt;artifactId&amp;gt;hutool-all&amp;lt;/artifactId&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;lt;version&amp;gt;5.3.7&amp;lt;/version&amp;gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;lt;groupId&amp;gt;org.apache.poi&amp;lt;/groupId&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;lt;artifactId&amp;gt;poi-ooxml&amp;lt;/artifactId&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;lt;version&amp;gt;5.2.3&amp;lt;/version&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h3 id=&#34;导入&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#导入&#34;&gt;#&lt;/a&gt; 导入&lt;/h3&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;@PostMapping(&amp;quot;/import&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;public Result importData(MultipartFile file) throws IOException &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ExcelReader reader = ExcelUtil.getReader(file.getInputStream());&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    List&amp;lt;User&amp;gt; userList = reader.readAll(User.class);//读取所有数据并转成user类&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    // 写入数据到数据库&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    try &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        userService.saveBatch(userList);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; catch (Exception e) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        e.printStackTrace();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        return Result.error(&amp;quot;数据批量导入错误&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    return Result.success();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;details&gt;&lt;summary&gt;解析&lt;/summary&gt;&lt;div&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;ExcelUtil&lt;/strong&gt; ： Hutool-poi 模块中的一个工具类，用于处理 Excel 文件的读写。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;通过 &lt;strong&gt;ExcelUtil.getReader(file.getInputStream())&lt;/strong&gt; 获取了一个 &lt;strong&gt;ExcelReader&lt;/strong&gt; 对象&lt;/li&gt;
&lt;li&gt;使用 &lt;strong&gt;reader.readAll(User.class)&lt;/strong&gt; 读取了 Excel 中的所有数据并将其转换为 &lt;strong&gt;User&lt;/strong&gt; 类的对象列表。&lt;/li&gt;
&lt;li&gt;最后将这些对象列表通过 &lt;strong&gt;userService.saveBatch(userList)&lt;/strong&gt; 写入到数据库中。&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;/div&gt;&lt;/details&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;@GetMapping(&amp;quot;/export&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;public void exportData(@RequestParam(required = false) String username,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                       @RequestParam(required = false) String name,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                       @RequestParam(required = false) String ids,//1,2,3,4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                       HttpServletResponse response) throws IOException &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ExcelWriter writer = ExcelUtil.getWriter(true);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    List&amp;lt;User&amp;gt; list;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    QueryWrapper&amp;lt;User&amp;gt; queryWrapper = new QueryWrapper&amp;lt;&amp;gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    if (StrUtil.isNotBlank(ids)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        // 将逗号分隔的字符串转换为整数列表：[&amp;quot;1&amp;quot;,&amp;quot;2&amp;quot;,&amp;quot;3&amp;quot;]  =&amp;gt;[1,2,3]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        List&amp;lt;Integer&amp;gt; idsArr1 = Arrays.stream(ids.split(regex &amp;quot;,&amp;quot;)).map(Integer::value0f).collect(Collectors.tolist());&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        queryWrapper.in(column: &amp;quot;id&amp;quot;, idsArr1);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; else &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        // 第一种全部导出或者条件导出&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        queryWrapper.like(StrUtil.isNotBlank(username), column: &amp;quot;username&amp;quot;, username);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        queryWrapper.like(StrUtil.isNotBlank(name), column: &amp;quot;name&amp;quot;, name);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    list = userService.list(queryWrapper);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    // 将查询到的用户数据写入 Excel&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    writer.write(list, true);//告知那些key是头，让后把key一样的value放在同一列&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    // 设置浏览器响应的格式&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;response.setContentType(&amp;quot;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=utf-8&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;response.setHeader(&amp;quot;Content-Disposition&amp;quot;, &amp;quot;attachment;filename=&amp;quot; + URLEncoder.encode(&amp;quot;用户信息表&amp;quot;, &amp;quot;UTF-8&amp;quot;) + &amp;quot;.xlsx&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ServletOutputStream out = response.getOutputStream();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;writer.flush(out, true);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;out.close();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;writer.close();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;details&gt;&lt;summary&gt;解析&lt;/summary&gt;&lt;div&gt;
&lt;blockquote&gt;
&lt;p&gt;判断前端是否有传过来 ids，有就将其转成数组并 queryWrapper 查询出，没有就根据其他条件查询出数据列表&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;创建 ExcelWriter 对象，参数为是否是 XLSX 格式&lt;/li&gt;
&lt;li&gt;将查询到的用户数据写入 Excel，并告知那些 key 是表头，让后把 key 一样的 value 放在同一列&lt;/li&gt;
&lt;li&gt;设置浏览器响应的格式和文件名&lt;/li&gt;
&lt;li&gt;通过 &lt;strong&gt;writer.flush(out, true)&lt;/strong&gt; 将 Excel 数据输出到浏览器。&lt;/li&gt;
&lt;li&gt;最后关闭输出流和 ExcelWriter 对象&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;/div&gt;&lt;/details&gt;
&lt;h3 id=&#34;如何给导出的excel表头设置中文&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#如何给导出的excel表头设置中文&#34;&gt;#&lt;/a&gt; 如何给导出的 excel 表头设置中文？&lt;/h3&gt;
&lt;p&gt;只需要在实体类的属性上面加一个注解 @Alias (&amp;quot;中文&amp;quot;)&lt;br /&gt;
&lt;img data-src=&#34;https://s2.loli.net/2024/01/16/sPVjA85DLTYcekw.png&#34; alt=&#34;输入图片说明&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;list里的对象有键值对键为表头值为表头下的内容&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#list里的对象有键值对键为表头值为表头下的内容&#34;&gt;#&lt;/a&gt; list 里的对象有键值对，键为表头，值为表头下的内容&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;查询出来的 list 里是一条条 user 对象，所以有键值对&lt;br /&gt;
&lt;img data-src=&#34;https://s2.loli.net/2024/01/16/fesVv3dWSytCnor.png&#34; alt=&#34;输入图片说明&#34; /&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9kb2MuaHV0b29sLmNuL3BhZ2VzL0V4Y2VsV3JpdGVyLyNfMi0lRTUlODYlOTklRTUlODclQkFtYXAlRTYlOTUlQjAlRTYlOEQlQUU=&#34;&gt;Excel 生成 - ExcelWriter | Hutool&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;map 数据的写法&lt;br /&gt;
&lt;img data-src=&#34;https://s2.loli.net/2024/01/16/PtLFrJlR7Ei1O8N.png&#34; alt=&#34;输入图片说明&#34; /&gt;&lt;br /&gt;
 &lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;@GetMapping(&amp;quot;/export&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;public void exportData(@RequestParam(required = false) String username,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                       @RequestParam(required = false) String name,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                       @RequestParam(required = false) String ids,//1,2,3,4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                       HttpServletResponse response) throws IOException &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ExcelWriter writer = ExcelUtil.getWriter(true);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    List&amp;lt;User&amp;gt; list;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    QueryWrapper&amp;lt;User&amp;gt; queryWrapper = new QueryWrapper&amp;lt;&amp;gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    if (StrUtil.isNotBlank(ids)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        // 将逗号分隔的字符串转换为整数列表：[&amp;quot;1&amp;quot;,&amp;quot;2&amp;quot;,&amp;quot;3&amp;quot;]  =&amp;gt;[1,2,3]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        List&amp;lt;Integer&amp;gt; idsArr1 = Arrays.stream(ids.split(regex &amp;quot;,&amp;quot;)).map(Integer::value0f).collect(Collectors.tolist());&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        queryWrapper.in(column: &amp;quot;id&amp;quot;, idsArr1);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; else &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        // 第一种全部导出或者条件导出&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        queryWrapper.like(StrUtil.isNotBlank(username), column: &amp;quot;username&amp;quot;, username);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        queryWrapper.like(StrUtil.isNotBlank(name), column: &amp;quot;name&amp;quot;, name);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    list = userService.list(queryWrapper);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    // 将查询到的用户数据写入 Excel&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    writer.write(list, true);//告知那些key是头，让后把key一样的value放在同一列&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    // 设置浏览器响应的格式&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;response.setContentType(&amp;quot;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=utf-8&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;response.setHeader(&amp;quot;Content-Disposition&amp;quot;, &amp;quot;attachment;filename=&amp;quot; + URLEncoder.encode(&amp;quot;用户信息表&amp;quot;, &amp;quot;UTF-8&amp;quot;) + &amp;quot;.xlsx&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ServletOutputStream out = response.getOutputStream();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;writer.flush(out, true);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;out.close();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;writer.close();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;@PostMapping(&amp;quot;/import&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;public Result importData(MultipartFile file) throws IOException &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ExcelReader reader = ExcelUtil.getReader(file.getInputStream());&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    List&amp;lt;User&amp;gt; userList = reader.readAll(User.class);//读取所有数据并转成user类&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    // 写入数据到数据库&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    try &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        userService.saveBatch(userList);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; catch (Exception e) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        e.printStackTrace();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        return Result.error(&amp;quot;数据批量导入错误&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    return Result.success();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;​&lt;/p&gt;
 ]]></description>
        </item>
    </channel>
</rss>
